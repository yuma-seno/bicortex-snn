# Bi-Cortex SNN (BC-SNN) Project Master Checklist

## Phase 0: プロジェクト立ち上げ & 準備
- [ ] **リポジトリ管理**
    - [x] Gitリポジトリの初期化 (`bicortex-snn`)
    - [ ] `.gitignore` の設定 (Python, Model weights, Temporary files, .DS_Store)
- [ ] **開発環境の準備 (Dev Containers)**
    - [x] **構成ファイルの作成**:
        - [x] `.devcontainer/nvidia/devcontainer.json`, `.devcontainer/nvidia/Dockerfile`, `.devcontainer/nvidia/docker-compose.yml` (NVIDIA CUDA用)
        - [x] `.devcontainer/amd/devcontainer.json`, `.devcontainer/amd/Dockerfile`, `.devcontainer/amd/docker-compose.yml` (AMD ROCm用)
        - [x] 共通エントリーポイントスクリプト `.devcontainer/entrypoint.sh`
    - [ ] **コンテナの起動と動作確認**:
        - [ ] Nvidia GPU 搭載環境での確認:
            - [ ] VS Codeで「Reopen in Container」を実行し、`python-nvidia`を選択
            - [ ] `python -c "import torch; print(torch.cuda.is_available())"` が `True` になることを確認
        - [x] AMD GPU 搭載環境での確認:
            - [x] VS Codeで「Reopen in Container」を実行し、`python-amd`を選択
            - [x] `python -c "import torch; print(torch.cuda.is_available())"` が `True` になることを確認
- [x] **ドキュメント整備 [DOC]**
    - [x] `README.md` 作成: プロジェクト概要、NVIDIA/AMD環境の切り替え手順を記述

## Phase 1: コアロジック検証 (Proof of Concept)
### 1.1 ニューロンモデル実装 (NumPy)
- [ ] **クラス設計**: 層を持たないフラットなクラス構造 (`BiCortexEngine`) の定義
- [ ] **LIFダイナミクス**: 行列演算による膜電位更新ロジックの実装
- [ ] **2つのトレース変数**:
    - [ ] `x_fast` (即時トレース: ~20ms) の実装
    - [ ] `e_slow` (適格性トレース: ~2.0s) の実装と減衰率調整
- [ ] **不応期 (Refractory Period)**: 発火後の強制リセット処理の実装
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `docs/math_model.md` 作成: 実装したLIFモデルとトレース更新の数式、コード上の変数名の対応表を記述

### 1.2 結合トポロジー構築
- [ ] **領域マップ定義**: `Thinking` / `Memory` のID範囲設定
- [ ] **固定結合 ($W_{fixed}$)**: 思考野内部、および概念→記憶野の投射結合の初期化
- [ ] **可塑的結合 ($W_{plastic}$)**: 記憶野リカレント、インターフェース結合の初期化 (Zero or Random initialization)
- [ ] **抑制性ニューロン**: Dale's Lawに基づく抑制性結合 (20%) のマスク処理
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `docs/architecture.md` 作成: ニューロンIDの割り当て範囲(Map)と、各結合行列の初期化戦略(スパース率など)を記録

### 1.3 学習アルゴリズム (SRG) 実装
- [ ] **ゲート信号 $G(t)$**: 概念ニューロンの活動総和による閾値判定ロジック
- [ ] **更新則**: $\Delta W = \eta \cdot G(t) \cdot Post \cdot Pre_{slow}$ の計算実装
- [ ] **正規化/クリッピング**: 重みが発散しないための上限設定 (`np.clip`)

### 1.4 動作検証 (パブロフ・テスト)
- [ ] **シナリオ作成**: ベル(予兆) → 空白時間 → エサ(報酬) の入力シーケンス作成
- [ ] **シミュレーション実行**: 学習前後での挙動比較
- [ ] **可視化**:
    - [ ] スパイクラスタープロット (Raster Plot) の描画
    - [ ] アクションニューロンの活動履歴グラフ
    - [ ] 重み行列 ($W_{plastic}$) のヒートマップ確認
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase1_poc.md` 作成: 実験結果のグラフを貼り付け、想定通り学習できたパラメータ設定（学習率 $\eta$、時定数 $\tau$ 等）を記録

## Phase 2: 視覚エンコーディング統合
### 2.1 視覚野バックボーン準備
- [ ] **モデル選定**: `MobileNetV3-Small` (Pre-trained) のロード
- [ ] **特徴抽出**: 最終層直前のFeature Mapを取り出すフックの実装
- [ ] **エンコーディング**: 特徴量の値を電流値に変換するマッパーの実装
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `docs/encoding_spec.md` 作成: CNNの特徴マップ次元数と、それをどうSNN入力電流に変換したか（正規化手法など）を記述

### 2.2 空間ナビゲーション環境
- [ ] **グリッドワールド作成**: 障害物、ゴール、エージェントが存在する簡易環境の実装
- [ ] **ループ接続**: 画像取得 → CNN → SNN → 行動 → 環境更新 のループ実装
- [ ] **テスト走行**: 障害物を回避してゴールできるか検証
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase2_navigation.md` 作成: 視覚情報を使ったナビゲーションの成功率、課題点を記録

## Phase 3: リアルタイム・アクション適応
### 3.1 ゲーム環境構築
- [ ] **環境選定**: OpenAI Gym (Atari) または PyGameによる自作避けゲー
- [ ] **リセット処理**: ゲームオーバー時にSNNの膜電位・トレースをクリアする機能の実装 (※重みは保持)

### 3.2 適応能力テスト
- [ ] **シナリオA (通常)**: 予測可能な敵の動きでの動作確認
- [ ] **シナリオB (変化)**: 特定の予兆(色/音)後に敵の動きが変わるロジック実装
- [ ] **学習評価**:
    - [ ] シナリオBへの切り替え後、何回のミスで回避を学習するか計測
    - [ ] 長時間稼働時のメモリ(重み)安定性確認
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase3_adaptation_log.md` 作成: 学習曲線（試行回数 vs 生存時間）のグラフ化、および長期稼働時の重み発散有無の分析結果を記述

## Phase 4: [Experimental] Spiking LLM 統合実験
### 4.1 S-LLM 準備
- [ ] **モデル調査**: `RWKV` や `SpikingJelly` で利用可能な小型モデルの選定
- [ ] **思考野への置換**: Phase 2のCNN部分を S-LLM に置き換える設計変更
- [ ] **スパイク入出力**: テキストトークン ⇔ スパイク信号 のコンバータ実装
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `docs/llm_integration.md` 作成: 採用したLLMモデルの詳細と、SNNへの接続アーキテクチャ図を更新

### 4.2 言語指示実験
- [ ] **連想タスク**: 「"右"という単語(S-LLM発火)」と「右移動(Action)」の結合学習
- [ ] **文脈保持**: 複雑な指示(「赤なら右、青なら左」)を記憶野に保持できるか検証
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase4_llm_experiment.md` 作成: LLMによるコンテキスト注入の効果検証レポート

## Final Review & Archiving
- [ ] **仕様書の最終更新**: 実装と乖離した箇所を `specifications.md` に反映（完全一致させる）
- [ ] **デモ動画作成**: 学習過程のスクリーンキャプチャをGIF/MP4化し `README.md` に追加
- [ ] **将来の課題リスト化**: エッジデバイス移植に向けた計算量ボトルネック等の課題整理 (`TODO.md`)