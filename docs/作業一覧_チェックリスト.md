# Bi-Cortex SNN (BC-SNN) Project Master Checklist

## Phase 0: プロジェクト立ち上げ & 準備
- [x] **リポジトリ管理**
    - [x] Gitリポジトリの初期化 (`bicortex-snn`)
    - [x] `.gitignore` の設定 (Python, Model weights, Temporary files, .DS_Store)
- [ ] **開発環境の準備 (Dev Containers)**
    - [x] **構成ファイルの作成**:
        - [x] `.devcontainer/nvidia/` (CUDA用)
        - [x] `.devcontainer/amd/` (ROCm用)
        - [x] `.devcontainer/entrypoint.sh` (権限自動解決スクリプト)
    - [ ] **コンテナの起動と動作確認**:
        - [ ] Nvidia GPU 搭載環境での確認:
            - [ ] VS Codeで「Reopen in Container」を実行し、`python-nvidia`を選択
            - [ ] `python -c "import torch; print(torch.cuda.is_available())"` が `True` になることを確認
        - [x] AMD GPU 搭載環境での確認:
            - [x] VS Codeで「Reopen in Container」を実行し、`python-amd`を選択
            - [x] `python -c "import torch; print(torch.cuda.is_available())"` が `True` になることを確認
- [x] **ドキュメント整備 [DOC]**
    - [x] `README.md` 作成: プロジェクト概要、NVIDIA/AMD環境の切り替え手順を記述

## Phase 1: コアロジック検証 (Proof of Concept)
### 1.1 ニューロンモデル実装 (NumPy)
- [x] **クラス設計**: 層を持たないフラットなクラス構造 (`BiCortexEngine`) の定義
- [x] **LIFダイナミクス**: 行列演算による膜電位更新ロジックの実装
- [x] **2つのトレース変数**:
    - [x] `x_fast` (即時トレース: ~20ms) の実装
    - [x] `e_slow` (適格性トレース: ~2.0s) の実装と減衰率調整
- [x] **不応期**: 安全なステップ数計算 (`max(1, ...)`) の実装
- [x] **ドキュメント更新 [DOC]**
    - [x] `docs/math_model.md`: LIFモデル、トレース変数の数式定義

### 1.2 結合トポロジー構築
- [x] **領域マップ定義**: Input/Hidden/Motor (Thinking) および Memory のID割当
- [x] **固定結合 ($W_{fixed}$)**: 思考野内部(Input->Hidden->Motor)および Context Injection の実装
- [x] **可塑的結合 ($W_{plastic}$)**: 記憶野リカレント(自己結合なし)、インターフェース結合の初期化
- [x] **抑制性ニューロン**: Dale's Lawに基づく初期重み設定 (記憶野20%)
- [x] **ドキュメント更新 [DOC]**
    - [x] `docs/architecture.md`: 領域定義、結合ルールの詳細記述

### 1.3 学習アルゴリズム (SRG) 実装
- [x] **ゲート信号 $G(t)$**: 活動移動平均(MA)と相対閾値(Ratio)による動的判定ロジック
- [x] **更新則**: Soft-bound Hebbian 則 ($\Delta W \propto (Limit-W) \cdot G \cdot Post \cdot Pre_{slow}$) の実装
- [x] **安定化処理**: Global Weight Decay (全体減衰) および安全なクリッピングの実装
- [x] **ドキュメント更新 [DOC]**
    - [x] `docs/math_model.md`: SRG (Soft-bound) および制約事項の追記

### 1.4 動作検証 (パブロフ・テスト)
- [x] **シナリオ作成**: ベル(予兆) → 空白時間 → エサ(報酬) の入力シーケンス作成
- [x] **シミュレーション実行**: 学習前後での挙動比較
    - [x] 初期ショート（漏洩）の特定と切断
    - [x] 暴走（Bursting）の抑制と、順応（Adaptation）による自然な減衰の実現
- [x] **可視化**:
    - [x] アクションニューロンの活動履歴グラフ作成 (`reports/figures/pavlov_result.png`)
    - [x] 重み行列の推移確認
- [x] **ドキュメント更新 [DOC]**
    - [x] `docs/architecture.md`: リザーバ固定化と順応メカニズムの反映
    - [x] `docs/math_model.md`: 適応的閾値の数式追加

## Phase 2: 視覚エンコーディング統合
### 2.1 視覚野バックボーン準備
- [ ] **モデル選定**: `MobileNetV3-Small` (Pre-trained) のロード
- [ ] **特徴抽出**: 最終層直前のFeature Mapを取り出すフックの実装
- [ ] **エンコーディング**: 特徴量の値を電流値に変換するマッパーの実装
- [ ] **最適化検討**: ニューロン数増加に伴う、疎行列 (Sparse Matrix) 導入の検討と実装
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `docs/encoding_spec.md` 作成: CNNの特徴マップ次元数と、それをどうSNN入力電流に変換したか（正規化手法など）を記述

### 2.2 空間ナビゲーション環境
- [ ] **グリッドワールド作成**: 障害物、ゴール、エージェントが存在する簡易環境の実装
- [ ] **ループ接続**: 画像取得 → CNN → SNN → 行動 → 環境更新 のループ実装
- [ ] **テスト走行**: 障害物を回避してゴールできるか検証
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase2_navigation.md` 作成: 視覚情報を使ったナビゲーションの成功率、課題点を記録

## Phase 3: リアルタイム・アクション適応
### 3.1 ゲーム環境構築
- [ ] **環境選定**: OpenAI Gym (Atari) または PyGameによる自作避けゲー
- [ ] **リセット処理**: ゲームオーバー時にSNNの膜電位・トレースをクリアする機能の実装 (※重みは保持)
- [ ] **最適化実装**: 学習ループ(`_update_weights`)のベクトル化による高速化対応

### 3.2 適応能力テスト
- [ ] **シナリオA (通常)**: 予測可能な敵の動きでの動作確認
- [ ] **シナリオB (変化)**: 特定の予兆(色/音)後に敵の動きが変わるロジック実装
- [ ] **学習評価**:
    - [ ] シナリオBへの切り替え後、何回のミスで回避を学習するか計測
    - [ ] 長時間稼働時のメモリ(重み)安定性確認
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase3_adaptation_log.md` 作成: 学習曲線（試行回数 vs 生存時間）のグラフ化、および長期稼働時の重み発散有無の分析結果を記述

## Phase 4: [Experimental] Spiking LLM 統合実験
### 4.1 S-LLM 準備
- [ ] **モデル調査**: `RWKV` や `SpikingJelly` で利用可能な小型モデルの選定
- [ ] **思考野への置換**: Phase 2のCNN部分を S-LLM に置き換える設計変更
- [ ] **スパイク入出力**: テキストトークン ⇔ スパイク信号 のコンバータ実装
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `docs/llm_integration.md` 作成: 採用したLLMモデルの詳細と、SNNへの接続アーキテクチャ図を更新

### 4.2 言語指示実験
- [ ] **連想タスク**: 「"右"という単語(S-LLM発火)」と「右移動(Action)」の結合学習
- [ ] **文脈保持**: 複雑な指示(「赤なら右、青なら左」)を記憶野に保持できるか検証
- [ ] **ドキュメント更新 [DOC]**
    - [ ] `reports/phase4_llm_experiment.md` 作成: LLMによるコンテキスト注入の効果検証レポート

## Final Review & Archiving
- [ ] **仕様書の最終更新**: 実装と乖離した箇所を `specifications.md` に反映（完全一致させる）
- [ ] **デモ動画作成**: 学習過程のスクリーンキャプチャをGIF/MP4化し `README.md` に追加
- [ ] **将来の課題リスト化**: (`TODO.md`)
    - [ ] エッジデバイス移植に向けた計算量ボトルネックの解消
    - [ ] 思考野(Thinking Cortex)への抑制性ニューロン導入の検討